{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport useIsPiecePinned from \"./Check for pin\";\nimport pinFilter from \"./Pin filter\";\nimport canCastle from \"./Allow castling\";\nimport { useSelector } from 'react-redux';\nimport useKingCoordinates from '../King activity/Find king';\nimport useCheckForChecks from '../King activity/Checks';\nexport default function useFilterNextMoves() {\n  _s();\n\n  const {\n    gameField,\n    coverMoves,\n    turn\n  } = useSelector(store => store.chess);\n  let [color, piece] = gameField[y][x];\n  const isPiecePinned = useIsPiecePinned([x, y]);\n  const checkForChecks = useCheckForChecks();\n  const king = useKingCoordinates(turn + \"K\");\n  const castlingMoves = canCastle(x, y);\n  let newMoves = nextMoves.filter(_ref => {\n    let [x, y] = _ref;\n    return x >= 0 && x < 8 && y >= 0 && y < 8 && gameField[y][x][0] !== color;\n  });\n\n  if (piece === \"K\") {\n    newMoves = newMoves.filter(move => !checkForChecks(move));\n    newMoves.push(...castlingMoves);\n  }\n\n  if (piece === \"P\") {\n    newMoves = newMoves.filter(_ref2 => {\n      let [a, b] = _ref2;\n      return !(a === x && gameField[b][a] !== \"0\");\n    });\n  }\n\n  if (coverMoves.length && piece !== \"K\") {\n    let saves = coverMoves.map(elm => elm.toString());\n    newMoves = newMoves.filter(move => saves.includes(move.toString()));\n  }\n\n  if (isPiecePinned) {\n    console.log(color + piece, \"is Pinned\");\n    newMoves = newMoves.filter(move => pinFilter(move, [x, y], king));\n  }\n\n  return newMoves;\n}\n\n_s(useFilterNextMoves, \"L2mpWvpZkwaA3dacvSjy+8/UhHY=\", false, function () {\n  return [useSelector, useIsPiecePinned, useCheckForChecks, useKingCoordinates];\n});","map":{"version":3,"names":["useIsPiecePinned","pinFilter","canCastle","useSelector","useKingCoordinates","useCheckForChecks","useFilterNextMoves","gameField","coverMoves","turn","store","chess","color","piece","y","x","isPiecePinned","checkForChecks","king","castlingMoves","newMoves","nextMoves","filter","move","push","a","b","length","saves","map","elm","toString","includes","console","log"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Game/Pieces/Logic/Next moves/Filtration.js"],"sourcesContent":["import useIsPiecePinned from \"./Check for pin\";\r\nimport pinFilter from \"./Pin filter\";\r\nimport canCastle from \"./Allow castling\";\r\nimport { useSelector } from 'react-redux';\r\nimport useKingCoordinates from '../King activity/Find king';\r\nimport useCheckForChecks from '../King activity/Checks';\r\n\r\nexport default function useFilterNextMoves(){\r\n\r\n    const { gameField, coverMoves, turn } = useSelector(store => store.chess)\r\n    let [color, piece] = gameField[y][x]\r\n\r\n    const isPiecePinned = useIsPiecePinned([x, y])\r\n    const checkForChecks = useCheckForChecks()\r\n    const king = useKingCoordinates(turn + \"K\")\r\n    const castlingMoves = canCastle(x, y)\r\n\r\n    let newMoves = nextMoves.filter(([x,y])=>\r\n        x >= 0 && x < 8\r\n        && y >= 0 && y < 8\r\n        && gameField[y][x][0] !== color\r\n    )\r\n\r\n    if (piece === \"K\"){\r\n        newMoves = newMoves.filter(move => !checkForChecks(move))\r\n        newMoves.push(...castlingMoves)\r\n    }\r\n\r\n    if (piece === \"P\"){\r\n        newMoves = newMoves.filter(([a, b]) => ! (a === x && gameField[b][a] !== \"0\"))\r\n    }\r\n\r\n    if (coverMoves.length && piece !== \"K\"){\r\n        let saves = coverMoves.map(elm => elm.toString())\r\n        newMoves = newMoves.filter(move => saves.includes(move.toString()))\r\n    }\r\n\r\n    if (isPiecePinned){\r\n        console.log(color + piece, \"is Pinned\")\r\n        newMoves = newMoves.filter(move => pinFilter(move, [x,y], king))\r\n    }\r\n\r\n    return newMoves\r\n\r\n}"],"mappings":";;AAAA,OAAOA,gBAAP,MAA6B,iBAA7B;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,OAAOC,SAAP,MAAsB,kBAAtB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,kBAAP,MAA+B,4BAA/B;AACA,OAAOC,iBAAP,MAA8B,yBAA9B;AAEA,eAAe,SAASC,kBAAT,GAA6B;EAAA;;EAExC,MAAM;IAAEC,SAAF;IAAaC,UAAb;IAAyBC;EAAzB,IAAkCN,WAAW,CAACO,KAAK,IAAIA,KAAK,CAACC,KAAhB,CAAnD;EACA,IAAI,CAACC,KAAD,EAAQC,KAAR,IAAiBN,SAAS,CAACO,CAAD,CAAT,CAAaC,CAAb,CAArB;EAEA,MAAMC,aAAa,GAAGhB,gBAAgB,CAAC,CAACe,CAAD,EAAID,CAAJ,CAAD,CAAtC;EACA,MAAMG,cAAc,GAAGZ,iBAAiB,EAAxC;EACA,MAAMa,IAAI,GAAGd,kBAAkB,CAACK,IAAI,GAAG,GAAR,CAA/B;EACA,MAAMU,aAAa,GAAGjB,SAAS,CAACa,CAAD,EAAID,CAAJ,CAA/B;EAEA,IAAIM,QAAQ,GAAGC,SAAS,CAACC,MAAV,CAAiB;IAAA,IAAC,CAACP,CAAD,EAAGD,CAAH,CAAD;IAAA,OAC5BC,CAAC,IAAI,CAAL,IAAUA,CAAC,GAAG,CAAd,IACGD,CAAC,IAAI,CADR,IACaA,CAAC,GAAG,CADjB,IAEGP,SAAS,CAACO,CAAD,CAAT,CAAaC,CAAb,EAAgB,CAAhB,MAAuBH,KAHE;EAAA,CAAjB,CAAf;;EAMA,IAAIC,KAAK,KAAK,GAAd,EAAkB;IACdO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgBC,IAAI,IAAI,CAACN,cAAc,CAACM,IAAD,CAAvC,CAAX;IACAH,QAAQ,CAACI,IAAT,CAAc,GAAGL,aAAjB;EACH;;EAED,IAAIN,KAAK,KAAK,GAAd,EAAkB;IACdO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgB;MAAA,IAAC,CAACG,CAAD,EAAIC,CAAJ,CAAD;MAAA,OAAY,EAAGD,CAAC,KAAKV,CAAN,IAAWR,SAAS,CAACmB,CAAD,CAAT,CAAaD,CAAb,MAAoB,GAAlC,CAAZ;IAAA,CAAhB,CAAX;EACH;;EAED,IAAIjB,UAAU,CAACmB,MAAX,IAAqBd,KAAK,KAAK,GAAnC,EAAuC;IACnC,IAAIe,KAAK,GAAGpB,UAAU,CAACqB,GAAX,CAAeC,GAAG,IAAIA,GAAG,CAACC,QAAJ,EAAtB,CAAZ;IACAX,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgBC,IAAI,IAAIK,KAAK,CAACI,QAAN,CAAeT,IAAI,CAACQ,QAAL,EAAf,CAAxB,CAAX;EACH;;EAED,IAAIf,aAAJ,EAAkB;IACdiB,OAAO,CAACC,GAAR,CAAYtB,KAAK,GAAGC,KAApB,EAA2B,WAA3B;IACAO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgBC,IAAI,IAAItB,SAAS,CAACsB,IAAD,EAAO,CAACR,CAAD,EAAGD,CAAH,CAAP,EAAcI,IAAd,CAAjC,CAAX;EACH;;EAED,OAAOE,QAAP;AAEH;;GArCuBd,kB;UAEoBH,W,EAGlBH,gB,EACCK,iB,EACVD,kB"},"metadata":{},"sourceType":"module"}