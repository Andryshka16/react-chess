{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setCoverMoves } from '../../../../../features/chess/chessSlice';\nimport useGetNextMoves from '../Next moves/NextMoves';\nexport default function useCheckMate() {\n  _s();\n\n  const {\n    gameField,\n    turn\n  } = useSelector(store => store.chess);\n  const dispatch = useDispatch();\n  const getNextMoves = useGetNextMoves();\n  return (king, check, amount) => {\n    const coverMoves = [];\n    const kingEscape = [];\n    let [x1, y1] = king;\n    let [x2, y2] = check;\n    kingEscape = [...getNextMoves([x1, y1])];\n\n    if (amount > 1) {\n      if (!kingEscape.length) {\n        coverMoves.push('Double mate');\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n    let xK = x1 === x2 ? 0 : 1;\n    let yK = y1 === y2 ? 0 : 1;\n\n    if (gameField[y2][x2][1] !== 'N') {\n      for (let i = 1; i * xK + Math.min(x1, x2) < Math.max(x1, x2) || i * yK + Math.min(y1, y2) < Math.max(y1, y2); i++) {\n        coverMoves.push([x1 + (x1 < x2 ? i : -i) * xK, y1 + (y1 < y2 ? i : -i) * yK]);\n      }\n    }\n\n    coverMoves.push([x2, y2]);\n    dispatch(setCoverMoves(coverMoves));\n\n    for (let y = 0; y < 8; y++) {\n      for (let x = 0; x < 8; x++) {\n        let piece = gameField[y][x];\n\n        if (piece[0] === turn && getNextMoves([x, y]).length) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n}\n\n_s(useCheckMate, \"E/8IIboSqzxv4vIzb0DHxNvhdnI=\", false, function () {\n  return [useSelector, useDispatch, useGetNextMoves];\n});","map":{"version":3,"names":["useDispatch","useSelector","setCoverMoves","useGetNextMoves","useCheckMate","gameField","turn","store","chess","dispatch","getNextMoves","king","check","amount","coverMoves","kingEscape","x1","y1","x2","y2","length","push","xK","yK","i","Math","min","max","y","x","piece"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Game/Pieces/Logic/King activity/Mate.js"],"sourcesContent":["import { useDispatch, useSelector } from 'react-redux'\r\nimport { setCoverMoves } from '../../../../../features/chess/chessSlice'\r\nimport useGetNextMoves from '../Next moves/NextMoves'\r\n\r\n\r\nexport default function useCheckMate() {\r\n\tconst { gameField, turn } = useSelector((store) => store.chess)\r\n\tconst dispatch = useDispatch()\r\n\tconst getNextMoves = useGetNextMoves()\r\n\r\n    return (king, check, amount) => {\r\n        \r\n        const coverMoves = []\r\n        const kingEscape = []\r\n\r\n\t\tlet [x1, y1] = king\r\n\t\tlet [x2, y2] = check\r\n\r\n\t\tkingEscape = [...getNextMoves([x1, y1])]\r\n\r\n\t\tif (amount > 1) {\r\n\t\t\tif (!kingEscape.length) {\r\n\t\t\t\tcoverMoves.push('Double mate')\r\n\t\t\t\treturn true\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet xK = x1 === x2 ? 0 : 1\r\n\t\tlet yK = y1 === y2 ? 0 : 1\r\n\r\n\t\tif (gameField[y2][x2][1] !== 'N') {\r\n\t\t\tfor (\r\n\t\t\t\tlet i = 1;\r\n\t\t\t\ti * xK + Math.min(x1, x2) < Math.max(x1, x2) ||\r\n\t\t\t\ti * yK + Math.min(y1, y2) < Math.max(y1, y2);\r\n\t\t\t\ti++\r\n\t\t\t) {\r\n\t\t\t\tcoverMoves.push([\r\n\t\t\t\t\tx1 + (x1 < x2 ? i : -i) * xK,\r\n\t\t\t\t\ty1 + (y1 < y2 ? i : -i) * yK,\r\n\t\t\t\t])\r\n\t\t\t}\r\n\t\t}\r\n\t\tcoverMoves.push([x2, y2])\r\n        dispatch(setCoverMoves(coverMoves))\r\n\r\n\r\n\t\tfor (let y = 0; y < 8; y++) {\r\n\t\t\tfor (let x = 0; x < 8; x++) {\r\n\t\t\t\tlet piece = gameField[y][x]\r\n\t\t\t\tif (piece[0] === turn && getNextMoves([x, y]).length) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t}\r\n}\r\n"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,aAAT,QAA8B,0CAA9B;AACA,OAAOC,eAAP,MAA4B,yBAA5B;AAGA,eAAe,SAASC,YAAT,GAAwB;EAAA;;EACtC,MAAM;IAAEC,SAAF;IAAaC;EAAb,IAAsBL,WAAW,CAAEM,KAAD,IAAWA,KAAK,CAACC,KAAlB,CAAvC;EACA,MAAMC,QAAQ,GAAGT,WAAW,EAA5B;EACA,MAAMU,YAAY,GAAGP,eAAe,EAApC;EAEG,OAAO,CAACQ,IAAD,EAAOC,KAAP,EAAcC,MAAd,KAAyB;IAE5B,MAAMC,UAAU,GAAG,EAAnB;IACA,MAAMC,UAAU,GAAG,EAAnB;IAEN,IAAI,CAACC,EAAD,EAAKC,EAAL,IAAWN,IAAf;IACA,IAAI,CAACO,EAAD,EAAKC,EAAL,IAAWP,KAAf;IAEAG,UAAU,GAAG,CAAC,GAAGL,YAAY,CAAC,CAACM,EAAD,EAAKC,EAAL,CAAD,CAAhB,CAAb;;IAEA,IAAIJ,MAAM,GAAG,CAAb,EAAgB;MACf,IAAI,CAACE,UAAU,CAACK,MAAhB,EAAwB;QACvBN,UAAU,CAACO,IAAX,CAAgB,aAAhB;QACA,OAAO,IAAP;MACA,CAHD,MAGO;QACN,OAAO,KAAP;MACA;IACD;;IAED,IAAIC,EAAE,GAAGN,EAAE,KAAKE,EAAP,GAAY,CAAZ,GAAgB,CAAzB;IACA,IAAIK,EAAE,GAAGN,EAAE,KAAKE,EAAP,GAAY,CAAZ,GAAgB,CAAzB;;IAEA,IAAId,SAAS,CAACc,EAAD,CAAT,CAAcD,EAAd,EAAkB,CAAlB,MAAyB,GAA7B,EAAkC;MACjC,KACC,IAAIM,CAAC,GAAG,CADT,EAECA,CAAC,GAAGF,EAAJ,GAASG,IAAI,CAACC,GAAL,CAASV,EAAT,EAAaE,EAAb,CAAT,GAA4BO,IAAI,CAACE,GAAL,CAASX,EAAT,EAAaE,EAAb,CAA5B,IACAM,CAAC,GAAGD,EAAJ,GAASE,IAAI,CAACC,GAAL,CAAST,EAAT,EAAaE,EAAb,CAAT,GAA4BM,IAAI,CAACE,GAAL,CAASV,EAAT,EAAaE,EAAb,CAH7B,EAICK,CAAC,EAJF,EAKE;QACDV,UAAU,CAACO,IAAX,CAAgB,CACfL,EAAE,GAAG,CAACA,EAAE,GAAGE,EAAL,GAAUM,CAAV,GAAc,CAACA,CAAhB,IAAqBF,EADX,EAEfL,EAAE,GAAG,CAACA,EAAE,GAAGE,EAAL,GAAUK,CAAV,GAAc,CAACA,CAAhB,IAAqBD,EAFX,CAAhB;MAIA;IACD;;IACDT,UAAU,CAACO,IAAX,CAAgB,CAACH,EAAD,EAAKC,EAAL,CAAhB;IACMV,QAAQ,CAACP,aAAa,CAACY,UAAD,CAAd,CAAR;;IAGN,KAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;MAC3B,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;QAC3B,IAAIC,KAAK,GAAGzB,SAAS,CAACuB,CAAD,CAAT,CAAaC,CAAb,CAAZ;;QACA,IAAIC,KAAK,CAAC,CAAD,CAAL,KAAaxB,IAAb,IAAqBI,YAAY,CAAC,CAACmB,CAAD,EAAID,CAAJ,CAAD,CAAZ,CAAqBR,MAA9C,EAAsD;UACrD,OAAO,KAAP;QACA;MACD;IACD;;IAED,OAAO,IAAP;EACA,CAjDE;AAkDH;;GAvDuBhB,Y;UACKH,W,EACXD,W,EACIG,e"},"metadata":{},"sourceType":"module"}