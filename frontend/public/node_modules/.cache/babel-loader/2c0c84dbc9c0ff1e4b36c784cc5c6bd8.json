{"ast":null,"code":"export default function movePiece(state, _ref) {\n  let {\n    payload\n  } = _ref;\n  const [x2, y2] = payload;\n  const {\n    x1,\n    y1,\n    name\n  } = state.selected;\n  const [color, piece] = name;\n  const {\n    turn,\n    turns\n  } = state;\n\n  if (piece === 'K' && Math.abs(x2 - x1) > 1) {\n    const k = x2 > x1 ? 1 : -1;\n    state.gameField[y1][4 + k] = color + 'R';\n    state.gameField[y1][4 + 2 * k] = color + 'K';\n    state.gameField[y1][4] = '0';\n    state.gameField[y1][k > 0 ? 7 : 0] = '0';\n  } else if (piece === 'P' && (y2 === 7 || y2 === 0)) {\n    state.promoted = {\n      x1,\n      y1,\n      x2,\n      y2,\n      name\n    };\n    state.gameField[y1][x1] = '0';\n  } else {\n    state.gameField[y2][x2] = name;\n    state.gameField[y1][x1] = '0';\n  }\n\n  if (piece === 'P' && x1 !== x2 && state.gameField[y2][x2] === '0') {\n    state.gameField[y1][x2] = '0';\n  }\n\n  if (piece === 'R' && (x1 === 0 || x1 === 7) && !state.castlingMoved.includes(x1 + name)) {\n    state.castlingMoved.push(x1 + name);\n  } else if (piece === 'K' && x1 === 4 && !state.castlingMoved.includes(name)) {\n    state.castlingMoved.push(name);\n  }\n\n  state.enPassing = name[1] === 'P' && Math.abs(y2 - y1) === 2 ? {\n    x2,\n    y2\n  } : null;\n  state.turn = turns[turn];\n  state.selected = null;\n  state.coverMoves = [];\n  state.nextMoves = [];\n}","map":{"version":3,"names":["movePiece","state","payload","x2","y2","x1","y1","name","selected","color","piece","turn","turns","Math","abs","k","gameField","promoted","castlingMoved","includes","push","enPassing","coverMoves","nextMoves"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/features/chess/reducers/movePiece.js"],"sourcesContent":["export default function movePiece(state, { payload }) {\r\n\tconst [x2, y2] = payload\r\n\tconst { x1, y1, name } = state.selected\r\n\tconst [color, piece] = name\r\n\tconst { turn, turns } = state\r\n\r\n\tif (piece === 'K' && Math.abs(x2 - x1) > 1) {\r\n\t\tconst k = x2 > x1 ? 1 : -1\r\n\t\tstate.gameField[y1][4 + k] = color + 'R'\r\n\t\tstate.gameField[y1][4 + 2 * k] = color + 'K'\r\n\t\tstate.gameField[y1][4] = '0'\r\n\t\tstate.gameField[y1][k > 0 ? 7 : 0] = '0'\r\n\t} else if (piece === 'P' && (y2 === 7 || y2 === 0)) {\r\n\t\tstate.promoted = { x1, y1, x2, y2, name }\r\n\t\tstate.gameField[y1][x1] = '0'\r\n\t} else {\r\n\t\tstate.gameField[y2][x2] = name\r\n\t\tstate.gameField[y1][x1] = '0'\r\n\t}\r\n\r\n\tif (piece === 'P' && x1 !== x2 && state.gameField[y2][x2] === '0') {\r\n\t\tstate.gameField[y1][x2] = '0'\r\n\t}\r\n\tif (\r\n\t\tpiece === 'R' &&\r\n\t\t(x1 === 0 || x1 === 7) &&\r\n\t\t!state.castlingMoved.includes(x1 + name)\r\n\t) {\r\n\t\tstate.castlingMoved.push(x1 + name)\r\n\t} else if (\r\n\t\tpiece === 'K' &&\r\n\t\tx1 === 4 &&\r\n\t\t!state.castlingMoved.includes(name)\r\n\t) {\r\n\t\tstate.castlingMoved.push(name)\r\n\t}\r\n\r\n\tstate.enPassing =\r\n\t\tname[1] === 'P' && Math.abs(y2 - y1) === 2 ? { x2, y2 } : null\r\n\r\n\tstate.turn = turns[turn]\r\n\tstate.selected = null\r\n\tstate.coverMoves = []\r\n\tstate.nextMoves = []\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}