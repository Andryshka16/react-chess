{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport useIsPiecePinned from './Check for pin';\nimport pinFilter from './Pin filter';\nimport useCastling from './Castling';\nimport { useSelector } from 'react-redux';\nimport useKingCoordinates from '../King activity/King coordinates';\nimport useCheckForChecks from '../King activity/Checks';\nexport default function useFilterNextMoves() {\n  _s();\n\n  const {\n    gameField,\n    coverMoves: _coverMoves,\n    turn\n  } = useSelector(store => store.chess);\n  const isPiecePinned = useIsPiecePinned();\n  const checkForChecks = useCheckForChecks();\n  const castling = useCastling();\n  const king = useKingCoordinates(turn + 'K');\n  return (x, y, nextMoves, coverMoves_) => {\n    const coverMoves = coverMoves_ || _coverMoves;\n    let [color, piece] = gameField[y][x];\n    let newMoves = nextMoves.filter(_ref => {\n      let [x, y] = _ref;\n      return x >= 0 && x < 8 && y >= 0 && y < 8 && gameField[y][x][0] !== color;\n    });\n\n    if (piece === 'K') {\n      newMoves = newMoves.filter(move => !checkForChecks(move).length);\n      newMoves.push(...canCastle(x, y));\n    }\n\n    if (piece === 'P') {\n      newMoves = newMoves.filter(_ref2 => {\n        let [a, b] = _ref2;\n        return !(a === x && gameField[b][a] !== '0');\n      });\n    }\n\n    if (coverMoves.length && piece !== 'K') {\n      let saves = coverMoves.map(elm => elm.toString());\n      newMoves = newMoves.filter(move => saves.includes(move.toString()));\n    }\n\n    if (isPiecePinned([x, y])) {\n      console.log(color + piece, 'is Pinned');\n      newMoves = newMoves.filter(move => pinFilter(move, [x, y], king));\n    }\n\n    return newMoves;\n  };\n}\n\n_s(useFilterNextMoves, \"pFSaHwktLnHK055mAISM7K1oXDo=\", false, function () {\n  return [useSelector, useIsPiecePinned, useCheckForChecks, useCastling, useKingCoordinates];\n});","map":{"version":3,"names":["useIsPiecePinned","pinFilter","useCastling","useSelector","useKingCoordinates","useCheckForChecks","useFilterNextMoves","gameField","coverMoves","_coverMoves","turn","store","chess","isPiecePinned","checkForChecks","castling","king","x","y","nextMoves","coverMoves_","color","piece","newMoves","filter","move","length","push","canCastle","a","b","saves","map","elm","toString","includes","console","log"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Chess/Pieces/Logic/Next moves/Filtration.js"],"sourcesContent":["import useIsPiecePinned from './Check for pin'\r\nimport pinFilter from './Pin filter'\r\nimport useCastling from './Castling'\r\nimport { useSelector } from 'react-redux'\r\nimport useKingCoordinates from '../King activity/King coordinates'\r\nimport useCheckForChecks from '../King activity/Checks'\r\n\r\nexport default function useFilterNextMoves() {\r\n\tconst { gameField, coverMoves: _coverMoves, turn } = useSelector((store) => store.chess)\r\n\r\n\tconst isPiecePinned = useIsPiecePinned()\r\n\tconst checkForChecks = useCheckForChecks()\r\n\tconst castling = useCastling()\r\n\tconst king = useKingCoordinates(turn + 'K')\r\n\r\n\treturn (x, y, nextMoves, coverMoves_) => {\r\n\r\n\t\tconst coverMoves = coverMoves_ || _coverMoves \r\n\r\n\t\tlet [color, piece] = gameField[y][x]\r\n\t\tlet newMoves = nextMoves.filter(\r\n\t\t\t([x, y]) =>\r\n\t\t\t\tx >= 0 &&\r\n\t\t\t\tx < 8 &&\r\n\t\t\t\ty >= 0 &&\r\n\t\t\t\ty < 8 &&\r\n\t\t\t\tgameField[y][x][0] !== color\r\n\t\t)\r\n\r\n\t\tif (piece === 'K') {\r\n\t\t\tnewMoves = newMoves.filter((move) => !checkForChecks(move).length)\r\n\t\t\tnewMoves.push(...canCastle(x, y))\r\n\t\t}\r\n\r\n\t\tif (piece === 'P') {\r\n\t\t\tnewMoves = newMoves.filter(\r\n\t\t\t\t([a, b]) => !(a === x && gameField[b][a] !== '0')\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tif (coverMoves.length && piece !== 'K') {\r\n\t\t\tlet saves = coverMoves.map((elm) => elm.toString())\r\n\t\t\tnewMoves = newMoves.filter((move) =>\r\n\t\t\t\tsaves.includes(move.toString())\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tif (isPiecePinned([x, y])) {\r\n\t\t\tconsole.log(color + piece, 'is Pinned')\r\n\t\t\tnewMoves = newMoves.filter((move) => pinFilter(move, [x, y], king))\r\n\t\t}\r\n\r\n\t\treturn newMoves\r\n\t}\r\n}\r\n"],"mappings":";;AAAA,OAAOA,gBAAP,MAA6B,iBAA7B;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,OAAOC,WAAP,MAAwB,YAAxB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,kBAAP,MAA+B,mCAA/B;AACA,OAAOC,iBAAP,MAA8B,yBAA9B;AAEA,eAAe,SAASC,kBAAT,GAA8B;EAAA;;EAC5C,MAAM;IAAEC,SAAF;IAAaC,UAAU,EAAEC,WAAzB;IAAsCC;EAAtC,IAA+CP,WAAW,CAAEQ,KAAD,IAAWA,KAAK,CAACC,KAAlB,CAAhE;EAEA,MAAMC,aAAa,GAAGb,gBAAgB,EAAtC;EACA,MAAMc,cAAc,GAAGT,iBAAiB,EAAxC;EACA,MAAMU,QAAQ,GAAGb,WAAW,EAA5B;EACA,MAAMc,IAAI,GAAGZ,kBAAkB,CAACM,IAAI,GAAG,GAAR,CAA/B;EAEA,OAAO,CAACO,CAAD,EAAIC,CAAJ,EAAOC,SAAP,EAAkBC,WAAlB,KAAkC;IAExC,MAAMZ,UAAU,GAAGY,WAAW,IAAIX,WAAlC;IAEA,IAAI,CAACY,KAAD,EAAQC,KAAR,IAAiBf,SAAS,CAACW,CAAD,CAAT,CAAaD,CAAb,CAArB;IACA,IAAIM,QAAQ,GAAGJ,SAAS,CAACK,MAAV,CACd;MAAA,IAAC,CAACP,CAAD,EAAIC,CAAJ,CAAD;MAAA,OACCD,CAAC,IAAI,CAAL,IACAA,CAAC,GAAG,CADJ,IAEAC,CAAC,IAAI,CAFL,IAGAA,CAAC,GAAG,CAHJ,IAIAX,SAAS,CAACW,CAAD,CAAT,CAAaD,CAAb,EAAgB,CAAhB,MAAuBI,KALxB;IAAA,CADc,CAAf;;IASA,IAAIC,KAAK,KAAK,GAAd,EAAmB;MAClBC,QAAQ,GAAGA,QAAQ,CAACC,MAAT,CAAiBC,IAAD,IAAU,CAACX,cAAc,CAACW,IAAD,CAAd,CAAqBC,MAAhD,CAAX;MACAH,QAAQ,CAACI,IAAT,CAAc,GAAGC,SAAS,CAACX,CAAD,EAAIC,CAAJ,CAA1B;IACA;;IAED,IAAII,KAAK,KAAK,GAAd,EAAmB;MAClBC,QAAQ,GAAGA,QAAQ,CAACC,MAAT,CACV;QAAA,IAAC,CAACK,CAAD,EAAIC,CAAJ,CAAD;QAAA,OAAY,EAAED,CAAC,KAAKZ,CAAN,IAAWV,SAAS,CAACuB,CAAD,CAAT,CAAaD,CAAb,MAAoB,GAAjC,CAAZ;MAAA,CADU,CAAX;IAGA;;IAED,IAAIrB,UAAU,CAACkB,MAAX,IAAqBJ,KAAK,KAAK,GAAnC,EAAwC;MACvC,IAAIS,KAAK,GAAGvB,UAAU,CAACwB,GAAX,CAAgBC,GAAD,IAASA,GAAG,CAACC,QAAJ,EAAxB,CAAZ;MACAX,QAAQ,GAAGA,QAAQ,CAACC,MAAT,CAAiBC,IAAD,IAC1BM,KAAK,CAACI,QAAN,CAAeV,IAAI,CAACS,QAAL,EAAf,CADU,CAAX;IAGA;;IAED,IAAIrB,aAAa,CAAC,CAACI,CAAD,EAAIC,CAAJ,CAAD,CAAjB,EAA2B;MAC1BkB,OAAO,CAACC,GAAR,CAAYhB,KAAK,GAAGC,KAApB,EAA2B,WAA3B;MACAC,QAAQ,GAAGA,QAAQ,CAACC,MAAT,CAAiBC,IAAD,IAAUxB,SAAS,CAACwB,IAAD,EAAO,CAACR,CAAD,EAAIC,CAAJ,CAAP,EAAeF,IAAf,CAAnC,CAAX;IACA;;IAED,OAAOO,QAAP;EACA,CAtCD;AAuCA;;GA/CuBjB,kB;UAC8BH,W,EAE/BH,gB,EACCK,iB,EACNH,W,EACJE,kB"},"metadata":{},"sourceType":"module"}