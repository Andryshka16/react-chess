{"ast":null,"code":"import { clearField } from \"../../../Indicators/ShowNextMoves\";\nimport togglePointerEvents from \"../Pawn promotion/togglePointerEvents\";\nimport doCastling from \"./Related with king/Castle king\";\nimport removePiece from \"./Remove piece\";\nimport maybeCastlingPiecesMoved from \"./Related with king/Mby castling pieces moved\";\nimport updateState from \"./Update state\";\nimport { recentPieceCrd } from \"../../piece\";\nimport { gameField } from \"../../Gamefield\";\nimport { setPromoted } from \"../Pawn promotion/Promotion\";\nimport { setCheck } from \"../../../Indicators/ShowCheck\";\nexport let turn = \"w\";\nexport const updateTurn = value => turn = value;\nexport const turns = {\n  \"w\": \"b\",\n  \"b\": \"w\"\n};\nexport let enPassing;\nexport let castlingMoved = [];\nexport let clearCastlingMoved = () => castlingMoved = [];\nexport default function movePiece(x2, y2) {\n  clearField();\n  let [x1, y1, [color, name], piece, setPiece] = recentPieceCrd;\n  updateTurn(turns[turn]);\n  setCheck(false);\n\n  if (name === \"K\" && Math.abs(x2 - x1) > 1) {\n    updateState(doCastling, [x2, y2], true);\n    return;\n  }\n\n  if (gameField[y2][x2] !== \"0\") {\n    removePiece(x2, y2);\n  } else if (name === \"P\" && x1 !== x2 && gameField[y2][x2] === \"0\") {\n    removePiece(x2, y1);\n  }\n\n  enPassing = name === \"P\" && Math.abs(y2 - y1) === 2 ? {\n    x: x2,\n    y: y2\n  } : false;\n\n  if (name === \"P\" && (y2 === 7 || y2 === 0)) {\n    setPromoted([x2, y2]);\n    togglePointerEvents(\"none\");\n  }\n\n  maybeCastlingPiecesMoved(color, name, x1);\n  updateState(setPiece, {\n    x: x2,\n    y: y2,\n    from: {\n      x: x1,\n      y: y1\n    }\n  });\n}","map":{"version":3,"names":["clearField","togglePointerEvents","doCastling","removePiece","maybeCastlingPiecesMoved","updateState","recentPieceCrd","gameField","setPromoted","setCheck","turn","updateTurn","value","turns","enPassing","castlingMoved","clearCastlingMoved","movePiece","x2","y2","x1","y1","color","name","piece","setPiece","Math","abs","x","y","from"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Game/Pieces/Logic/Move piece/Move piece.js"],"sourcesContent":["import {clearField} from \"../../../Indicators/ShowNextMoves\";\r\nimport togglePointerEvents from \"../Pawn promotion/togglePointerEvents\";\r\nimport doCastling from \"./Related with king/Castle king\";\r\nimport removePiece from \"./Remove piece\";\r\nimport maybeCastlingPiecesMoved from \"./Related with king/Mby castling pieces moved\";\r\nimport updateState from \"./Update state\";\r\nimport {recentPieceCrd} from \"../../piece\";\r\nimport {gameField} from \"../../Gamefield\";\r\nimport {setPromoted} from \"../Pawn promotion/Promotion\";\r\nimport {setCheck} from \"../../../Indicators/ShowCheck\";\r\n\r\nexport let turn = \"w\"\r\nexport const updateTurn = value => turn = value\r\nexport const turns = {\"w\": \"b\", \"b\": \"w\"}\r\n\r\nexport let enPassing\r\nexport let castlingMoved = []\r\nexport let clearCastlingMoved = () => castlingMoved = []\r\n\r\nexport default function movePiece(x2, y2){\r\n\r\n    clearField()\r\n\r\n    let [x1, y1, [color, name], piece, setPiece] = recentPieceCrd\r\n\r\n    updateTurn(turns[turn])\r\n    setCheck(false)\r\n\r\n    if (name === \"K\" && Math.abs(x2 - x1) > 1){\r\n        updateState(doCastling, [x2, y2], true)\r\n        return\r\n    }\r\n\r\n    if (gameField[y2][x2] !== \"0\") {\r\n        removePiece(x2, y2)\r\n    }\r\n\r\n    else if (name === \"P\" && x1 !== x2 && gameField[y2][x2] === \"0\"){\r\n        removePiece(x2, y1)\r\n    }\r\n\r\n    enPassing = name === \"P\" &&\r\n        Math.abs(y2 - y1) === 2 ?\r\n            {x: x2, y: y2} : false\r\n\r\n    if (name === \"P\"  && (y2 === 7 || y2 === 0)){\r\n        setPromoted([x2, y2])\r\n        togglePointerEvents(\"none\")\r\n    }\r\n\r\n    maybeCastlingPiecesMoved(color, name, x1)\r\n\r\n    updateState(setPiece,{\r\n            x: x2,\r\n            y: y2,\r\n            from: {x: x1, y: y1}\r\n        })\r\n}\r\n"],"mappings":"AAAA,SAAQA,UAAR,QAAyB,mCAAzB;AACA,OAAOC,mBAAP,MAAgC,uCAAhC;AACA,OAAOC,UAAP,MAAuB,iCAAvB;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,wBAAP,MAAqC,+CAArC;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,SAAQC,cAAR,QAA6B,aAA7B;AACA,SAAQC,SAAR,QAAwB,iBAAxB;AACA,SAAQC,WAAR,QAA0B,6BAA1B;AACA,SAAQC,QAAR,QAAuB,+BAAvB;AAEA,OAAO,IAAIC,IAAI,GAAG,GAAX;AACP,OAAO,MAAMC,UAAU,GAAGC,KAAK,IAAIF,IAAI,GAAGE,KAAnC;AACP,OAAO,MAAMC,KAAK,GAAG;EAAC,KAAK,GAAN;EAAW,KAAK;AAAhB,CAAd;AAEP,OAAO,IAAIC,SAAJ;AACP,OAAO,IAAIC,aAAa,GAAG,EAApB;AACP,OAAO,IAAIC,kBAAkB,GAAG,MAAMD,aAAa,GAAG,EAA/C;AAEP,eAAe,SAASE,SAAT,CAAmBC,EAAnB,EAAuBC,EAAvB,EAA0B;EAErCnB,UAAU;EAEV,IAAI,CAACoB,EAAD,EAAKC,EAAL,EAAS,CAACC,KAAD,EAAQC,IAAR,CAAT,EAAwBC,KAAxB,EAA+BC,QAA/B,IAA2CnB,cAA/C;EAEAK,UAAU,CAACE,KAAK,CAACH,IAAD,CAAN,CAAV;EACAD,QAAQ,CAAC,KAAD,CAAR;;EAEA,IAAIc,IAAI,KAAK,GAAT,IAAgBG,IAAI,CAACC,GAAL,CAAST,EAAE,GAAGE,EAAd,IAAoB,CAAxC,EAA0C;IACtCf,WAAW,CAACH,UAAD,EAAa,CAACgB,EAAD,EAAKC,EAAL,CAAb,EAAuB,IAAvB,CAAX;IACA;EACH;;EAED,IAAIZ,SAAS,CAACY,EAAD,CAAT,CAAcD,EAAd,MAAsB,GAA1B,EAA+B;IAC3Bf,WAAW,CAACe,EAAD,EAAKC,EAAL,CAAX;EACH,CAFD,MAIK,IAAII,IAAI,KAAK,GAAT,IAAgBH,EAAE,KAAKF,EAAvB,IAA6BX,SAAS,CAACY,EAAD,CAAT,CAAcD,EAAd,MAAsB,GAAvD,EAA2D;IAC5Df,WAAW,CAACe,EAAD,EAAKG,EAAL,CAAX;EACH;;EAEDP,SAAS,GAAGS,IAAI,KAAK,GAAT,IACRG,IAAI,CAACC,GAAL,CAASR,EAAE,GAAGE,EAAd,MAAsB,CADd,GAEJ;IAACO,CAAC,EAAEV,EAAJ;IAAQW,CAAC,EAAEV;EAAX,CAFI,GAEa,KAFzB;;EAIA,IAAII,IAAI,KAAK,GAAT,KAAkBJ,EAAE,KAAK,CAAP,IAAYA,EAAE,KAAK,CAArC,CAAJ,EAA4C;IACxCX,WAAW,CAAC,CAACU,EAAD,EAAKC,EAAL,CAAD,CAAX;IACAlB,mBAAmB,CAAC,MAAD,CAAnB;EACH;;EAEDG,wBAAwB,CAACkB,KAAD,EAAQC,IAAR,EAAcH,EAAd,CAAxB;EAEAf,WAAW,CAACoB,QAAD,EAAU;IACbG,CAAC,EAAEV,EADU;IAEbW,CAAC,EAAEV,EAFU;IAGbW,IAAI,EAAE;MAACF,CAAC,EAAER,EAAJ;MAAQS,CAAC,EAAER;IAAX;EAHO,CAAV,CAAX;AAKH"},"metadata":{},"sourceType":"module"}