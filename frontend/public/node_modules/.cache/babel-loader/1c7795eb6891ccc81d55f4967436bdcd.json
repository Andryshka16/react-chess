{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport useIsPiecePinned from './Check for pin';\nimport pinFilter from './Pin filter';\nimport canCastle from './Allow castling';\nimport { useSelector } from 'react-redux';\nimport useKingCoordinates from '../King activity/Find king';\nimport useCheckForChecks from '../King activity/Checks';\nexport default function useFilterNextMoves() {\n  _s();\n\n  const {\n    gameField,\n    coverMoves,\n    turn\n  } = useSelector(store => store.chess);\n  let [color, piece] = gameField[y][x];\n  const isPiecePinned = useIsPiecePinned([x, y]);\n  const checkForChecks = useCheckForChecks();\n  const king = useKingCoordinates(turn + 'K');\n  const castlingMoves = canCastle(x, y);\n  return (x, y) => {\n    let newMoves = nextMoves.filter(_ref => {\n      let [x, y] = _ref;\n      return x >= 0 && x < 8 && y >= 0 && y < 8 && gameField[y][x][0] !== color;\n    });\n\n    if (piece === 'K') {\n      newMoves = newMoves.filter(move => !checkForChecks(move));\n      newMoves.push(...castlingMoves);\n    }\n\n    if (piece === 'P') {\n      newMoves = newMoves.filter(_ref2 => {\n        let [a, b] = _ref2;\n        return !(a === x && gameField[b][a] !== '0');\n      });\n    }\n\n    if (coverMoves.length && piece !== 'K') {\n      let saves = coverMoves.map(elm => elm.toString());\n      newMoves = newMoves.filter(move => saves.includes(move.toString()));\n    }\n\n    if (isPiecePinned) {\n      console.log(color + piece, 'is Pinned');\n      newMoves = newMoves.filter(move => pinFilter(move, [x, y], king));\n    }\n\n    return newMoves;\n  };\n}\n\n_s(useFilterNextMoves, \"L2mpWvpZkwaA3dacvSjy+8/UhHY=\", false, function () {\n  return [useSelector, useIsPiecePinned, useCheckForChecks, useKingCoordinates];\n});","map":{"version":3,"names":["useIsPiecePinned","pinFilter","canCastle","useSelector","useKingCoordinates","useCheckForChecks","useFilterNextMoves","gameField","coverMoves","turn","store","chess","color","piece","y","x","isPiecePinned","checkForChecks","king","castlingMoves","newMoves","nextMoves","filter","move","push","a","b","length","saves","map","elm","toString","includes","console","log"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Game/Pieces/Logic/Next moves/Filtration.js"],"sourcesContent":["import useIsPiecePinned from './Check for pin'\r\nimport pinFilter from './Pin filter'\r\nimport canCastle from './Allow castling'\r\nimport { useSelector } from 'react-redux'\r\nimport useKingCoordinates from '../King activity/Find king'\r\nimport useCheckForChecks from '../King activity/Checks'\r\n\r\nexport default function useFilterNextMoves() {\r\n\tconst { gameField, coverMoves, turn } = useSelector((store) => store.chess)\r\n\tlet [color, piece] = gameField[y][x]\r\n\r\n\tconst isPiecePinned = useIsPiecePinned([x, y])\r\n\tconst checkForChecks = useCheckForChecks()\r\n\tconst king = useKingCoordinates(turn + 'K')\r\n\tconst castlingMoves = canCastle(x, y)\r\n\r\n\treturn (x, y) => {\r\n\t\tlet newMoves = nextMoves.filter(\r\n\t\t\t([x, y]) =>\r\n\t\t\t\tx >= 0 &&\r\n\t\t\t\tx < 8 &&\r\n\t\t\t\ty >= 0 &&\r\n\t\t\t\ty < 8 &&\r\n\t\t\t\tgameField[y][x][0] !== color\r\n\t\t)\r\n\r\n\t\tif (piece === 'K') {\r\n\t\t\tnewMoves = newMoves.filter((move) => !checkForChecks(move))\r\n\t\t\tnewMoves.push(...castlingMoves)\r\n\t\t}\r\n\r\n\t\tif (piece === 'P') {\r\n\t\t\tnewMoves = newMoves.filter(\r\n\t\t\t\t([a, b]) => !(a === x && gameField[b][a] !== '0')\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tif (coverMoves.length && piece !== 'K') {\r\n\t\t\tlet saves = coverMoves.map((elm) => elm.toString())\r\n\t\t\tnewMoves = newMoves.filter((move) =>\r\n\t\t\t\tsaves.includes(move.toString())\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tif (isPiecePinned) {\r\n\t\t\tconsole.log(color + piece, 'is Pinned')\r\n\t\t\tnewMoves = newMoves.filter((move) => pinFilter(move, [x, y], king))\r\n\t\t}\r\n\r\n\t\treturn newMoves\r\n\t}\r\n}\r\n"],"mappings":";;AAAA,OAAOA,gBAAP,MAA6B,iBAA7B;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,OAAOC,SAAP,MAAsB,kBAAtB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,kBAAP,MAA+B,4BAA/B;AACA,OAAOC,iBAAP,MAA8B,yBAA9B;AAEA,eAAe,SAASC,kBAAT,GAA8B;EAAA;;EAC5C,MAAM;IAAEC,SAAF;IAAaC,UAAb;IAAyBC;EAAzB,IAAkCN,WAAW,CAAEO,KAAD,IAAWA,KAAK,CAACC,KAAlB,CAAnD;EACA,IAAI,CAACC,KAAD,EAAQC,KAAR,IAAiBN,SAAS,CAACO,CAAD,CAAT,CAAaC,CAAb,CAArB;EAEA,MAAMC,aAAa,GAAGhB,gBAAgB,CAAC,CAACe,CAAD,EAAID,CAAJ,CAAD,CAAtC;EACA,MAAMG,cAAc,GAAGZ,iBAAiB,EAAxC;EACA,MAAMa,IAAI,GAAGd,kBAAkB,CAACK,IAAI,GAAG,GAAR,CAA/B;EACA,MAAMU,aAAa,GAAGjB,SAAS,CAACa,CAAD,EAAID,CAAJ,CAA/B;EAEA,OAAO,CAACC,CAAD,EAAID,CAAJ,KAAU;IAChB,IAAIM,QAAQ,GAAGC,SAAS,CAACC,MAAV,CACd;MAAA,IAAC,CAACP,CAAD,EAAID,CAAJ,CAAD;MAAA,OACCC,CAAC,IAAI,CAAL,IACAA,CAAC,GAAG,CADJ,IAEAD,CAAC,IAAI,CAFL,IAGAA,CAAC,GAAG,CAHJ,IAIAP,SAAS,CAACO,CAAD,CAAT,CAAaC,CAAb,EAAgB,CAAhB,MAAuBH,KALxB;IAAA,CADc,CAAf;;IASA,IAAIC,KAAK,KAAK,GAAd,EAAmB;MAClBO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAiBC,IAAD,IAAU,CAACN,cAAc,CAACM,IAAD,CAAzC,CAAX;MACAH,QAAQ,CAACI,IAAT,CAAc,GAAGL,aAAjB;IACA;;IAED,IAAIN,KAAK,KAAK,GAAd,EAAmB;MAClBO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CACV;QAAA,IAAC,CAACG,CAAD,EAAIC,CAAJ,CAAD;QAAA,OAAY,EAAED,CAAC,KAAKV,CAAN,IAAWR,SAAS,CAACmB,CAAD,CAAT,CAAaD,CAAb,MAAoB,GAAjC,CAAZ;MAAA,CADU,CAAX;IAGA;;IAED,IAAIjB,UAAU,CAACmB,MAAX,IAAqBd,KAAK,KAAK,GAAnC,EAAwC;MACvC,IAAIe,KAAK,GAAGpB,UAAU,CAACqB,GAAX,CAAgBC,GAAD,IAASA,GAAG,CAACC,QAAJ,EAAxB,CAAZ;MACAX,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAiBC,IAAD,IAC1BK,KAAK,CAACI,QAAN,CAAeT,IAAI,CAACQ,QAAL,EAAf,CADU,CAAX;IAGA;;IAED,IAAIf,aAAJ,EAAmB;MAClBiB,OAAO,CAACC,GAAR,CAAYtB,KAAK,GAAGC,KAApB,EAA2B,WAA3B;MACAO,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAiBC,IAAD,IAAUtB,SAAS,CAACsB,IAAD,EAAO,CAACR,CAAD,EAAID,CAAJ,CAAP,EAAeI,IAAf,CAAnC,CAAX;IACA;;IAED,OAAOE,QAAP;EACA,CAlCD;AAmCA;;GA5CuBd,kB;UACiBH,W,EAGlBH,gB,EACCK,iB,EACVD,kB"},"metadata":{},"sourceType":"module"}