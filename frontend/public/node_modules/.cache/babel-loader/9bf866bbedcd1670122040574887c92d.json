{"ast":null,"code":"const turns = {\n  b: 'w',\n  w: 'b'\n};\nconst reducers = {\n  clearNextMoves: state => {\n    state.nextMoves = [];\n  },\n  setNextMoves: (state, _ref) => {\n    let {\n      payload\n    } = _ref;\n    state.nextMoves = payload;\n  },\n  setCheck: (state, _ref2) => {\n    let {\n      payload\n    } = _ref2;\n    state.check = payload;\n  },\n  setTurn: (state, _ref3) => {\n    let {\n      payload\n    } = _ref3;\n    state.turn = payload;\n  },\n  setSelected: (state, _ref4) => {\n    let {\n      payload\n    } = _ref4;\n    state.selected = payload;\n  },\n  setFollowing: (state, _ref5) => {\n    let {\n      payload\n    } = _ref5;\n    state.followingPiece = payload;\n  },\n  setPromoted: (state, _ref6) => {\n    let {\n      payload\n    } = _ref6;\n\n    if (!payload) {\n      const {\n        x1,\n        y1,\n        name\n      } = state.promoted;\n      state.gameField[y1][x1] = name;\n      state.promoted = payload;\n      console.log(turns);\n      state.turn = turns[state.turn];\n    } else if (payload.length > 1) {\n      state.promoted = payload;\n    } else {\n      const {\n        x2,\n        y2\n      } = state.promoted;\n      state.gameField[y2][x2] = payload.name;\n      state.promoted = null;\n    }\n  },\n  setCoverMoves: (state, _ref7) => {\n    let {\n      payload\n    } = _ref7;\n    state.coverMoves = payload;\n  },\n  movePiece: (state, _ref8) => {\n    let {\n      payload\n    } = _ref8;\n    const [x2, y2] = payload;\n    const {\n      x1,\n      y1,\n      name\n    } = state.selected;\n    const [color, piece] = name;\n\n    if (piece === 'K' && Math.abs(x2 - x1) > 1) {\n      const k = x2 > x1 ? 1 : -1;\n      state.gameField[y1][4 + k] = color + 'R';\n      state.gameField[y1][4 + 2 * k] = color + 'K';\n      state.gameField[y1][4] = '0';\n      state.gameField[y1][k > 0 ? 7 : 0] = '0';\n    } else if (piece === 'P' && x1 !== x2 && state.gameField[y2][x2] === '0') {\n      state.gameField[y1][x2] = '0';\n      state.gameField[y2][x2] = name;\n      state.gameField[y1][x1] = '0';\n    }\n\n    if (piece === 'P' && (y2 === 7 || y2 === 0)) {\n      state.promoted = {\n        x1,\n        y1,\n        x2,\n        y2,\n        name\n      };\n      state.gameField[y1][x1] = '0';\n    } else {\n      state.gameField[y2][x2] = name;\n      state.gameField[y1][x1] = '0';\n    }\n\n    if (piece === 'R' && (x1 === 0 || x1 === 7) && !state.castlingMoved.includes(x1 + name)) {\n      state.castlingMoved.push(x1 + name);\n    } else if (piece === 'K' && x1 === 4 && !state.castlingMoved.includes(name)) {\n      state.castlingMoved.push(name);\n    }\n\n    state.enPassing = name[1] === 'P' && Math.abs(y2 - y1) === 2 ? {\n      x2,\n      y2\n    } : null;\n    state.turn = turns[state.turn];\n    state.selected = null;\n    state.coverMoves = [];\n    state.nextMoves = [];\n  }\n};\nexport default reducers;","map":{"version":3,"names":["turns","b","w","reducers","clearNextMoves","state","nextMoves","setNextMoves","payload","setCheck","check","setTurn","turn","setSelected","selected","setFollowing","followingPiece","setPromoted","x1","y1","name","promoted","gameField","console","log","length","x2","y2","setCoverMoves","coverMoves","movePiece","color","piece","Math","abs","k","castlingMoved","includes","push","enPassing"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/features/chess/reducers.js"],"sourcesContent":["const turns = {\r\n\tb: 'w',\r\n\tw: 'b',\r\n}\r\n\r\n\r\nconst reducers = {\r\n\r\n\tclearNextMoves: (state) => {\r\n\t\tstate.nextMoves = []\r\n\t},\r\n\tsetNextMoves: (state, { payload }) => {\r\n\t\tstate.nextMoves = payload\r\n\t},\r\n\tsetCheck: (state, { payload }) => {\r\n\t\tstate.check = payload\r\n\t},\r\n\tsetTurn: (state, { payload }) => {\r\n\t\tstate.turn = payload\r\n\t},\r\n\tsetSelected: (state, { payload }) => {\r\n\t\tstate.selected = payload\r\n\t},\r\n\tsetFollowing: (state, { payload }) => {\r\n\t\tstate.followingPiece = payload\r\n\t},\r\n\tsetPromoted: (state, { payload }) => {\r\n\t\tif (!payload) {\r\n\t\t\tconst { x1, y1, name } = state.promoted\r\n\t\t\tstate.gameField[y1][x1] = name\r\n\t\t\tstate.promoted = payload\r\n\t\t\tconsole.log(turns);\r\n\t\t\tstate.turn = turns[state.turn]\r\n\t\t} else if (payload.length > 1) {\r\n\t\t\tstate.promoted = payload\r\n\t\t} else {\r\n\t\t\tconst { x2, y2 } = state.promoted\r\n\t\t\tstate.gameField[y2][x2] = payload.name\r\n\t\t\tstate.promoted = null\r\n\t\t}\r\n\t},\r\n\tsetCoverMoves: (state, { payload }) => {\r\n\t\tstate.coverMoves = payload\r\n\t},\r\n\tmovePiece: (state, { payload }) => {\r\n\t\tconst [x2, y2] = payload\r\n\t\tconst { x1, y1, name } = state.selected\r\n\t\tconst [color, piece] = name\r\n\r\n\t\tif (piece === 'K' && Math.abs(x2 - x1) > 1) {\r\n\t\t\tconst k = x2 > x1 ? 1 : -1\r\n\t\t\tstate.gameField[y1][4 + k] = color + 'R'\r\n\t\t\tstate.gameField[y1][4 + 2 * k] = color + 'K'\r\n\t\t\tstate.gameField[y1][4] = '0'\r\n\t\t\tstate.gameField[y1][k > 0 ? 7 : 0] = '0'\r\n\t\t} else if (\r\n\t\t\tpiece === 'P' &&\r\n\t\t\tx1 !== x2 &&\r\n\t\t\tstate.gameField[y2][x2] === '0'\r\n\t\t) {\r\n\t\t\tstate.gameField[y1][x2] = '0'\r\n\t\t\tstate.gameField[y2][x2] = name\r\n\t\t\tstate.gameField[y1][x1] = '0'\r\n\t\t}\r\n\r\n\t\tif (piece === 'P' && (y2 === 7 || y2 === 0)) {\r\n\t\t\tstate.promoted = { x1, y1, x2, y2, name }\r\n\t\t\tstate.gameField[y1][x1] = '0'\r\n\t\t} else {\r\n\t\t\tstate.gameField[y2][x2] = name\r\n\t\t\tstate.gameField[y1][x1] = '0'\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\tpiece === 'R' &&\r\n\t\t\t(x1 === 0 || x1 === 7) &&\r\n\t\t\t!state.castlingMoved.includes(x1 + name)\r\n\t\t) {\r\n\t\t\tstate.castlingMoved.push(x1 + name)\r\n\t\t} else if (\r\n\t\t\tpiece === 'K' &&\r\n\t\t\tx1 === 4 &&\r\n\t\t\t!state.castlingMoved.includes(name)\r\n\t\t) {\r\n\t\t\tstate.castlingMoved.push(name)\r\n\t\t}\r\n\r\n\t\tstate.enPassing =\r\n\t\t\tname[1] === 'P' && Math.abs(y2 - y1) === 2 ? { x2, y2 } : null\r\n\r\n\t\tstate.turn = turns[state.turn]\r\n\t\tstate.selected = null\r\n\t\tstate.coverMoves = []\r\n\t\tstate.nextMoves = []\r\n\t},\r\n}\r\n\r\nexport default reducers\r\n"],"mappings":"AAAA,MAAMA,KAAK,GAAG;EACbC,CAAC,EAAE,GADU;EAEbC,CAAC,EAAE;AAFU,CAAd;AAMA,MAAMC,QAAQ,GAAG;EAEhBC,cAAc,EAAGC,KAAD,IAAW;IAC1BA,KAAK,CAACC,SAAN,GAAkB,EAAlB;EACA,CAJe;EAKhBC,YAAY,EAAE,CAACF,KAAD,WAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IACrCH,KAAK,CAACC,SAAN,GAAkBE,OAAlB;EACA,CAPe;EAQhBC,QAAQ,EAAE,CAACJ,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IACjCH,KAAK,CAACK,KAAN,GAAcF,OAAd;EACA,CAVe;EAWhBG,OAAO,EAAE,CAACN,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IAChCH,KAAK,CAACO,IAAN,GAAaJ,OAAb;EACA,CAbe;EAchBK,WAAW,EAAE,CAACR,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IACpCH,KAAK,CAACS,QAAN,GAAiBN,OAAjB;EACA,CAhBe;EAiBhBO,YAAY,EAAE,CAACV,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IACrCH,KAAK,CAACW,cAAN,GAAuBR,OAAvB;EACA,CAnBe;EAoBhBS,WAAW,EAAE,CAACZ,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;;IACpC,IAAI,CAACA,OAAL,EAAc;MACb,MAAM;QAAEU,EAAF;QAAMC,EAAN;QAAUC;MAAV,IAAmBf,KAAK,CAACgB,QAA/B;MACAhB,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBD,EAApB,IAA0BE,IAA1B;MACAf,KAAK,CAACgB,QAAN,GAAiBb,OAAjB;MACAe,OAAO,CAACC,GAAR,CAAYxB,KAAZ;MACAK,KAAK,CAACO,IAAN,GAAaZ,KAAK,CAACK,KAAK,CAACO,IAAP,CAAlB;IACA,CAND,MAMO,IAAIJ,OAAO,CAACiB,MAAR,GAAiB,CAArB,EAAwB;MAC9BpB,KAAK,CAACgB,QAAN,GAAiBb,OAAjB;IACA,CAFM,MAEA;MACN,MAAM;QAAEkB,EAAF;QAAMC;MAAN,IAAatB,KAAK,CAACgB,QAAzB;MACAhB,KAAK,CAACiB,SAAN,CAAgBK,EAAhB,EAAoBD,EAApB,IAA0BlB,OAAO,CAACY,IAAlC;MACAf,KAAK,CAACgB,QAAN,GAAiB,IAAjB;IACA;EACD,CAlCe;EAmChBO,aAAa,EAAE,CAACvB,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IACtCH,KAAK,CAACwB,UAAN,GAAmBrB,OAAnB;EACA,CArCe;EAsChBsB,SAAS,EAAE,CAACzB,KAAD,YAAwB;IAAA,IAAhB;MAAEG;IAAF,CAAgB;IAClC,MAAM,CAACkB,EAAD,EAAKC,EAAL,IAAWnB,OAAjB;IACA,MAAM;MAAEU,EAAF;MAAMC,EAAN;MAAUC;IAAV,IAAmBf,KAAK,CAACS,QAA/B;IACA,MAAM,CAACiB,KAAD,EAAQC,KAAR,IAAiBZ,IAAvB;;IAEA,IAAIY,KAAK,KAAK,GAAV,IAAiBC,IAAI,CAACC,GAAL,CAASR,EAAE,GAAGR,EAAd,IAAoB,CAAzC,EAA4C;MAC3C,MAAMiB,CAAC,GAAGT,EAAE,GAAGR,EAAL,GAAU,CAAV,GAAc,CAAC,CAAzB;MACAb,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoB,IAAIgB,CAAxB,IAA6BJ,KAAK,GAAG,GAArC;MACA1B,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoB,IAAI,IAAIgB,CAA5B,IAAiCJ,KAAK,GAAG,GAAzC;MACA1B,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoB,CAApB,IAAyB,GAAzB;MACAd,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBgB,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAY,CAAhC,IAAqC,GAArC;IACA,CAND,MAMO,IACNH,KAAK,KAAK,GAAV,IACAd,EAAE,KAAKQ,EADP,IAEArB,KAAK,CAACiB,SAAN,CAAgBK,EAAhB,EAAoBD,EAApB,MAA4B,GAHtB,EAIL;MACDrB,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBO,EAApB,IAA0B,GAA1B;MACArB,KAAK,CAACiB,SAAN,CAAgBK,EAAhB,EAAoBD,EAApB,IAA0BN,IAA1B;MACAf,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBD,EAApB,IAA0B,GAA1B;IACA;;IAED,IAAIc,KAAK,KAAK,GAAV,KAAkBL,EAAE,KAAK,CAAP,IAAYA,EAAE,KAAK,CAArC,CAAJ,EAA6C;MAC5CtB,KAAK,CAACgB,QAAN,GAAiB;QAAEH,EAAF;QAAMC,EAAN;QAAUO,EAAV;QAAcC,EAAd;QAAkBP;MAAlB,CAAjB;MACAf,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBD,EAApB,IAA0B,GAA1B;IACA,CAHD,MAGO;MACNb,KAAK,CAACiB,SAAN,CAAgBK,EAAhB,EAAoBD,EAApB,IAA0BN,IAA1B;MACAf,KAAK,CAACiB,SAAN,CAAgBH,EAAhB,EAAoBD,EAApB,IAA0B,GAA1B;IACA;;IAED,IACCc,KAAK,KAAK,GAAV,KACCd,EAAE,KAAK,CAAP,IAAYA,EAAE,KAAK,CADpB,KAEA,CAACb,KAAK,CAAC+B,aAAN,CAAoBC,QAApB,CAA6BnB,EAAE,GAAGE,IAAlC,CAHF,EAIE;MACDf,KAAK,CAAC+B,aAAN,CAAoBE,IAApB,CAAyBpB,EAAE,GAAGE,IAA9B;IACA,CAND,MAMO,IACNY,KAAK,KAAK,GAAV,IACAd,EAAE,KAAK,CADP,IAEA,CAACb,KAAK,CAAC+B,aAAN,CAAoBC,QAApB,CAA6BjB,IAA7B,CAHK,EAIL;MACDf,KAAK,CAAC+B,aAAN,CAAoBE,IAApB,CAAyBlB,IAAzB;IACA;;IAEDf,KAAK,CAACkC,SAAN,GACCnB,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAZ,IAAmBa,IAAI,CAACC,GAAL,CAASP,EAAE,GAAGR,EAAd,MAAsB,CAAzC,GAA6C;MAAEO,EAAF;MAAMC;IAAN,CAA7C,GAA0D,IAD3D;IAGAtB,KAAK,CAACO,IAAN,GAAaZ,KAAK,CAACK,KAAK,CAACO,IAAP,CAAlB;IACAP,KAAK,CAACS,QAAN,GAAiB,IAAjB;IACAT,KAAK,CAACwB,UAAN,GAAmB,EAAnB;IACAxB,KAAK,CAACC,SAAN,GAAkB,EAAlB;EACA;AAxFe,CAAjB;AA2FA,eAAeH,QAAf"},"metadata":{},"sourceType":"module"}