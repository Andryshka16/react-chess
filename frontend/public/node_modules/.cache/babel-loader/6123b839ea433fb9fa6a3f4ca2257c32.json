{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { clearField } from \"../../../Indicators/ShowNextMoves\";\nimport togglePointerEvents from \"../Pawn promotion/togglePointerEvents\";\nimport doCastling from \"./Related with king/Castle king\";\nimport removePiece from \"./Remove piece\";\nimport maybeCastlingPiecesMoved from \"./Related with king/Mby castling pieces moved\";\nimport updateState from \"./Update state\";\nimport { recentPieceCrd } from \"../../piece\";\nimport { gameField } from \"../../Gamefield\";\nimport { setPromoted } from \"../Pawn promotion/Promotion\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { clearNextMoves, setCheck, setTurn } from '../../../../../features/chess/chessSlice';\nexport let turn = \"w\";\nexport const turns = {\n  \"w\": \"b\",\n  \"b\": \"w\"\n};\nexport let enPassing;\nexport let castlingMoved = [];\nexport let clearCastlingMoved = () => castlingMoved = [];\nexport default function useMovePiece(x2, y2) {\n  _s();\n\n  // clearField()\n  const dispatch = useDispatch();\n  dispatch(clearNextMoves());\n  dispatch(setCheck(false));\n  dispatch(setTurn(turns[turn]));\n  const {\n    gameField,\n    nextMoves,\n    selected\n  } = useSelector(store => store.chess);\n  const {\n    x: x1,\n    y: y1,\n    name: [color, name]\n  } = selected; // if (name === \"K\" && Math.abs(x2 - x1) > 1){\n  //     updateState(doCastling, [x2, y2], true)\n  //     return\n  // }\n\n  if (gameField[y2][x2] !== \"0\") {\n    removePiece(x2, y2);\n  } else if (name === \"P\" && x1 !== x2 && gameField[y2][x2] === \"0\") {\n    removePiece(x2, y1);\n  }\n\n  enPassing = name === \"P\" && Math.abs(y2 - y1) === 2 ? {\n    x: x2,\n    y: y2\n  } : false;\n\n  if (name === \"P\" && (y2 === 7 || y2 === 0)) {\n    setPromoted([x2, y2]);\n    togglePointerEvents(\"none\");\n  }\n\n  maybeCastlingPiecesMoved(color, name, x1); // updateState(setPiece,{\n  //         x: x2,\n  //         y: y2,\n  //         from: {x: x1, y: y1}\n  //     })\n}\n\n_s(useMovePiece, \"6/prURd2S0es5oARSUb9gvJkk9k=\", false, function () {\n  return [useDispatch, useSelector];\n});","map":{"version":3,"names":["clearField","togglePointerEvents","doCastling","removePiece","maybeCastlingPiecesMoved","updateState","recentPieceCrd","gameField","setPromoted","useDispatch","useSelector","clearNextMoves","setCheck","setTurn","turn","turns","enPassing","castlingMoved","clearCastlingMoved","useMovePiece","x2","y2","dispatch","nextMoves","selected","store","chess","x","x1","y","y1","name","color","Math","abs"],"sources":["C:/Users/alapc/OneDrive/Documents/Programming/chess/src/Chessboard/Game/Pieces/Logic/Move piece/Move piece.js"],"sourcesContent":["import {clearField} from \"../../../Indicators/ShowNextMoves\";\r\nimport togglePointerEvents from \"../Pawn promotion/togglePointerEvents\";\r\nimport doCastling from \"./Related with king/Castle king\";\r\nimport removePiece from \"./Remove piece\";\r\nimport maybeCastlingPiecesMoved from \"./Related with king/Mby castling pieces moved\";\r\nimport updateState from \"./Update state\";\r\nimport {recentPieceCrd} from \"../../piece\";\r\nimport {gameField} from \"../../Gamefield\";\r\nimport {setPromoted} from \"../Pawn promotion/Promotion\";\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { clearNextMoves,setCheck, setTurn } from '../../../../../features/chess/chessSlice';\r\n\r\nexport let turn = \"w\"\r\n\r\nexport const turns = {\"w\": \"b\", \"b\": \"w\"}\r\n\r\nexport let enPassing\r\nexport let castlingMoved = []\r\nexport let clearCastlingMoved = () => castlingMoved = []\r\n\r\nexport default function useMovePiece(x2, y2){\r\n\r\n    // clearField()\r\n    const dispatch = useDispatch()\r\n\r\n    dispatch(clearNextMoves())\r\n    dispatch(setCheck(false))\r\n    dispatch(setTurn(turns[turn]))\r\n\r\n    const {gameField, nextMoves, selected} = useSelector(store => store.chess)\r\n\r\n    const { x: x1, y: y1, name: [color, name] } = selected\r\n\r\n    // if (name === \"K\" && Math.abs(x2 - x1) > 1){\r\n    //     updateState(doCastling, [x2, y2], true)\r\n    //     return\r\n    // }\r\n\r\n    if (gameField[y2][x2] !== \"0\") {\r\n        removePiece(x2, y2)\r\n    }\r\n\r\n    else if (name === \"P\" && x1 !== x2 && gameField[y2][x2] === \"0\"){\r\n        removePiece(x2, y1)\r\n    }\r\n\r\n    enPassing = name === \"P\" &&\r\n        Math.abs(y2 - y1) === 2 ?\r\n            {x: x2, y: y2} : false\r\n\r\n    if (name === \"P\"  && (y2 === 7 || y2 === 0)){\r\n        setPromoted([x2, y2])\r\n        togglePointerEvents(\"none\")\r\n    }\r\n\r\n    maybeCastlingPiecesMoved(color, name, x1)\r\n\r\n    // updateState(setPiece,{\r\n    //         x: x2,\r\n    //         y: y2,\r\n    //         from: {x: x1, y: y1}\r\n    //     })\r\n}\r\n"],"mappings":";;AAAA,SAAQA,UAAR,QAAyB,mCAAzB;AACA,OAAOC,mBAAP,MAAgC,uCAAhC;AACA,OAAOC,UAAP,MAAuB,iCAAvB;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,wBAAP,MAAqC,+CAArC;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,SAAQC,cAAR,QAA6B,aAA7B;AACA,SAAQC,SAAR,QAAwB,iBAAxB;AACA,SAAQC,WAAR,QAA0B,6BAA1B;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,cAAT,EAAwBC,QAAxB,EAAkCC,OAAlC,QAAiD,0CAAjD;AAEA,OAAO,IAAIC,IAAI,GAAG,GAAX;AAEP,OAAO,MAAMC,KAAK,GAAG;EAAC,KAAK,GAAN;EAAW,KAAK;AAAhB,CAAd;AAEP,OAAO,IAAIC,SAAJ;AACP,OAAO,IAAIC,aAAa,GAAG,EAApB;AACP,OAAO,IAAIC,kBAAkB,GAAG,MAAMD,aAAa,GAAG,EAA/C;AAEP,eAAe,SAASE,YAAT,CAAsBC,EAAtB,EAA0BC,EAA1B,EAA6B;EAAA;;EAExC;EACA,MAAMC,QAAQ,GAAGb,WAAW,EAA5B;EAEAa,QAAQ,CAACX,cAAc,EAAf,CAAR;EACAW,QAAQ,CAACV,QAAQ,CAAC,KAAD,CAAT,CAAR;EACAU,QAAQ,CAACT,OAAO,CAACE,KAAK,CAACD,IAAD,CAAN,CAAR,CAAR;EAEA,MAAM;IAACP,SAAD;IAAYgB,SAAZ;IAAuBC;EAAvB,IAAmCd,WAAW,CAACe,KAAK,IAAIA,KAAK,CAACC,KAAhB,CAApD;EAEA,MAAM;IAAEC,CAAC,EAAEC,EAAL;IAASC,CAAC,EAAEC,EAAZ;IAAgBC,IAAI,EAAE,CAACC,KAAD,EAAQD,IAAR;EAAtB,IAAwCP,QAA9C,CAXwC,CAaxC;EACA;EACA;EACA;;EAEA,IAAIjB,SAAS,CAACc,EAAD,CAAT,CAAcD,EAAd,MAAsB,GAA1B,EAA+B;IAC3BjB,WAAW,CAACiB,EAAD,EAAKC,EAAL,CAAX;EACH,CAFD,MAIK,IAAIU,IAAI,KAAK,GAAT,IAAgBH,EAAE,KAAKR,EAAvB,IAA6Bb,SAAS,CAACc,EAAD,CAAT,CAAcD,EAAd,MAAsB,GAAvD,EAA2D;IAC5DjB,WAAW,CAACiB,EAAD,EAAKU,EAAL,CAAX;EACH;;EAEDd,SAAS,GAAGe,IAAI,KAAK,GAAT,IACRE,IAAI,CAACC,GAAL,CAASb,EAAE,GAAGS,EAAd,MAAsB,CADd,GAEJ;IAACH,CAAC,EAAEP,EAAJ;IAAQS,CAAC,EAAER;EAAX,CAFI,GAEa,KAFzB;;EAIA,IAAIU,IAAI,KAAK,GAAT,KAAkBV,EAAE,KAAK,CAAP,IAAYA,EAAE,KAAK,CAArC,CAAJ,EAA4C;IACxCb,WAAW,CAAC,CAACY,EAAD,EAAKC,EAAL,CAAD,CAAX;IACApB,mBAAmB,CAAC,MAAD,CAAnB;EACH;;EAEDG,wBAAwB,CAAC4B,KAAD,EAAQD,IAAR,EAAcH,EAAd,CAAxB,CAnCwC,CAqCxC;EACA;EACA;EACA;EACA;AACH;;GA1CuBT,Y;UAGHV,W,EAMwBC,W"},"metadata":{},"sourceType":"module"}